const updateAverage = () => {
  const ignoreSmall = ignoreCheckbox.checked;
  const selectedValue = parseFloat(typeSelect.value);
  let total = 0;
  let validCount = 0;
  let filteredCount = 0;

  document.querySelectorAll('.input-numbers').forEach(input => {
    const numbers = input.value.split('\n')
      .filter(line => line.length === 3 && !isNaN(parseInt(line)))
      .map(line => parseInt(line));
    
    numbers.forEach(num => {
      const diff = parseInt(targetInput.value) - num;
      const result = Math.trunc((diff / selectedValue)) / 10;
      
      // 유효한 입력 개수 카운트
      validCount++;
      total += num;
      
      // 필터링된 결과 개수 카운트
      if(!ignoreSmall || Math.abs(result) > 0.1) {
        filteredCount++;
      }
    });
  });

  const average = validCount > 0 ? (total / validCount).toFixed(1) : '0.0';
  averageDisplay.textContent = `평균:${average}(${filteredCount}개)`; // 공백 제거
};